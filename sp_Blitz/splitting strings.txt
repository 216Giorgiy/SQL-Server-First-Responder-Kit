/* http://stackoverflow.com/questions/6079103/tsql-udf-to-split-string-every-8-characters */

ALTER function dbo.SplitString
(   
    @str NVARCHAR(max),
    @length int
)
RETURNS @Results TABLE( Result NVARCHAR(4000),Sequence INT ) 
AS
BEGIN

DECLARE @Sequence INT 
SET @Sequence = 1

    DECLARE @s NVARCHAR(4000)
    WHILE len(@str) > 0
    BEGIN
        SET @s = left(@str, @length)
        INSERT @Results VALUES (@s,@Sequence)

        IF(len(@str)<@length)
        BREAK

        SET @str = right(@str, len(@str) - @length)
        SET @Sequence = @Sequence + 1
    END
    RETURN 
END;

